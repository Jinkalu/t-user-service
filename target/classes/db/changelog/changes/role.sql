-- liquibase formatted sql
--changeset vishnu:change_0001

CREATE TABLE role (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255) NOT NULL,
  description VARCHAR(255),
  is_enabled BOOLEAN NOT NULL,
   created_at BIGINT,
   updated_at BIGINT,
   created_by VARCHAR(255),
   updated_by VARCHAR(255),
  CONSTRAINT pk_role PRIMARY KEY (id)
);

CREATE TABLE role_permission (
  permission_id BIGINT NOT NULL,
  role_id BIGINT NOT NULL,
  CONSTRAINT pk_role_permission PRIMARY KEY (permission_id, role_id)
);

ALTER TABLE role_permission ADD CONSTRAINT fk_role_permission_on_permission FOREIGN KEY (permission_id) REFERENCES permission (id);

ALTER TABLE role_permission ADD CONSTRAINT fk_role_permission_on_role FOREIGN KEY (role_id) REFERENCES role (id);


insert into role
(
    name,
    description,
    is_enabled,
    created_at,
    updated_at,
    created_by,
    updated_by
)
values
(
    'ROLE_ADMIN',
    'Admin',
    true,
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    'SYSTEM',
    'SYSTEM'
),
(
    'ROLE_STAFF',
    'Staff',
    true,
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    'SYSTEM',
    'SYSTEM'
),
(
    'ROLE_COUNTRY_ADMIN',
    'Country Admin',
    true,
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    'SYSTEM',
    'SYSTEM'
),
(
    'ROLE_USER',
    'User',
    true,
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    EXTRACT(EPOCH FROM CURRENT_TIMESTAMP),
    'SYSTEM',
    'SYSTEM'
);
